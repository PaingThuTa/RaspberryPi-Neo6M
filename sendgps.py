import redis
import time

# Redis connection details
redis_client = redis.StrictRedis(
    host="redis-13242.crce178.ap-east-1-1.ec2.redns.redis-cloud.com",
    port=13242,
    password="z1WTBRd81HGrGckawMz6oHtHNOoXAAR3",
    decode_responses=True
)

# Tram GPS data
gps_data = [
    (13.612263, 100.836828), (13.612389, 100.836676), (13.612412, 100.836585),
    (13.612441, 100.836478), (13.612473, 100.836363), (13.612508, 100.836238),
    (13.612534, 100.836147), (13.612633, 100.835787), (13.612686, 100.835602),
    (13.612740, 100.835415), (13.612796, 100.835222), (13.612860, 100.835001),
    (13.612950, 100.834689), (13.613051, 100.834310), (13.613115, 100.833858),
    (13.613170, 100.833660), (13.613202, 100.833545), (13.613137, 100.833424),
    (13.613034, 100.833390), (13.612942, 100.833365), (13.612815, 100.833320),
    (13.612710, 100.833239), (13.612659, 100.833162), (13.612630, 100.833066),
    (13.612630, 100.832969), (13.612650, 100.832864), (13.612673, 100.832775),
    (13.612708, 100.832643), (13.612734, 100.832550), (13.612763, 100.832447),
    (13.612791, 100.832348), (13.612818, 100.832253), (13.612844, 100.832160),
    (13.612869, 100.832071), (13.612906, 100.831941), (13.612937, 100.831829),
    (13.612962, 100.831739), (13.612986, 100.831645), (13.613009, 100.831551),
    (13.613034, 100.831459), (13.613068, 100.831338), (13.613114, 100.831223)
]

tram_id = "tram_1"

def send_gps_to_redis():
    for lat, lon in gps_data:
        gps_payload = {"latitude": lat, "longitude": lon}
        redis_client.set(f"gps:{tram_id}", str(gps_payload))
        print(f"ðŸ“¡ Sent GPS Data to Redis: {gps_payload}")
        time.sleep(2)  # Wait 2 seconds before sending the next data point

if __name__ == "__main__":
    send_gps_to_redis()
